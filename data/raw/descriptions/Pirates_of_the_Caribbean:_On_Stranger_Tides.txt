Pirates of the Caribbean: On Stranger Tides is a 2011 American fantasy swashbuckler film directed by Rob Marshall and produced by Jerry Bruckheimer, from a screenplay by the writing team of Ted Elliott and Terry Rossio. The fourth installment in the Pirates of the Caribbean film series, it is loosely based on the 1987 novel On Stranger Tides by Tim Powers and serves as a stand-alone sequel to At World's End (2007). The film stars Johnny Depp, Geoffrey Rush, and Kevin R. McNally, who reprise their roles from the previous films, alongside Penélope Cruz, Ian McShane, Sam Claflin and Àstrid Bergès-Frisbey. The story follows the eccentric pirate Captain Jack Sparrow forced into a shaky alliance with Angelica, a mysterious woman from his past, as they embark on a quest for the Fountain of Youth. Jack is forced aboard the Queen Anne's Revenge, contends with the infamous pirate Blackbeard, and enters an uneasy alliance with rival Hector Barbossa.